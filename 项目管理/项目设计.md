## ğŸ¯ æœ€ç»ˆæŠ€æœ¯æ–¹æ¡ˆï¼šæ™ºèƒ½ç½‘é¡µæ— éšœç¢åŠ©æ‰‹

### ä¸€ã€ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·æµè§ˆå™¨                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ‚¬æµ®UIç»„ä»¶  â”‚â†â”€â”€â†’â”‚    ç½‘é¡µå†…å®¹åˆ†æå™¨           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚ WebSocket                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         â†“              åç«¯æœåŠ¡é›†ç¾¤                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   APIç½‘å…³    â”‚â”€â”€â”€â†’â”‚   ä»»åŠ¡è°ƒåº¦å™¨    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚         â”‚                     â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¯­éŸ³æœåŠ¡æ¨¡å— â”‚  MCPè¿æ¥æ±   â”‚ LLMç½‘å…³  â”‚ è‡ªåŠ¨åŒ–å¼•æ“â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           çŸ¥è¯†åº“ç³»ç»Ÿ (å‘é‡æ•°æ®åº“)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äºŒã€æ ¸å¿ƒæ¨¡å—è¯¦è§£

#### 1. **å‰ç«¯åµŒå…¥å¼SDK**
```typescript
// ä½¿ç”¨æ–¹å¼
<script src="https://your-domain/assistant-sdk.js"></script>
<script>
  WebAssistant.init({
    apiKey: 'your-api-key',
    position: 'bottom-right',
    theme: 'auto'
  });
</script>
```

**æŠ€æœ¯æ ˆ**ï¼š
- TypeScript + Preactï¼ˆä½“ç§¯å°ï¼‰
- Socket.io-clientï¼ˆå®æ—¶é€šä¿¡ï¼‰
- Web Speech APIï¼ˆè¯­éŸ³é‡‡é›†ï¼‰
- Tailwind CSSï¼ˆæ ·å¼ï¼‰

#### 2. **åç«¯æœåŠ¡æ¶æ„**

**æ ¸å¿ƒæœåŠ¡**ï¼š
```typescript
// ä¸»è¦æœåŠ¡æ¨¡å—
â”œâ”€â”€ gateway-service/        # APIç½‘å…³ï¼ˆFastifyï¼‰
â”œâ”€â”€ core-service/          # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ mcp-service/           # MCPè¿æ¥ç®¡ç†
â”œâ”€â”€ automation-service/    # æµè§ˆå™¨è‡ªåŠ¨åŒ–
â”œâ”€â”€ voice-service/         # è¯­éŸ³å¤„ç†
â””â”€â”€ knowledge-service/     # çŸ¥è¯†åº“æ£€ç´¢
```

**æŠ€æœ¯é€‰å‹**ï¼š
- **æ¡†æ¶**: Fastify + TypeScript
- **é€šä¿¡**: Socket.io + Redis Pub/Sub
- **ä»»åŠ¡é˜Ÿåˆ—**: BullMQ
- **çŠ¶æ€ç®¡ç†**: XState
- **å‘é‡æ•°æ®åº“**: PostgreSQL + pgvector
- **ç¼“å­˜**: Redis
- **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: Playwright

#### 3. **æ•°æ®æµè®¾è®¡**

```typescript
interface AssistantRequest {
  id: string
  type: 'voice' | 'text' | 'automation'
  content: string
  context: {
    pageUrl: string
    pageTitle: string
    userPreferences: UserPrefs
  }
}

interface TaskFlow {
  // 1. æ¥æ”¶è¯·æ±‚
  request: AssistantRequest
  
  // 2. æ„å›¾è¯†åˆ«
  intent: {
    action: 'search' | 'query' | 'automate' | 'help'
    confidence: number
    parameters: any
  }
  
  // 3. æ‰§è¡Œè®¡åˆ’
  plan: ExecutionPlan[]
  
  // 4. æ‰§è¡Œç»“æœ
  result: {
    status: 'success' | 'partial' | 'failed'
    data: any
    followUp?: string
  }
}
```

### ä¸‰ã€åŠŸèƒ½æ¨¡å—å®ç°

#### 1. **MCPé›†æˆ**
```typescript
// MCPè¿æ¥ç®¡ç†å™¨
class MCPManager {
  private connections: Map<string, MCPConnection>
  
  async connectToServer(serverConfig: MCPServerConfig) {
    // ä½¿ç”¨ @modelcontextprotocol/sdk
  }
  
  async executeCommand(server: string, command: string, params: any) {
    // æ‰§è¡ŒMCPå‘½ä»¤
  }
}
```

#### 2. **çŸ¥è¯†åº“ç³»ç»Ÿ**
```typescript
// åŒå±‚çŸ¥è¯†åº“è®¾è®¡
interface KnowledgeBase {
  // é™æ€å±‚ï¼šé¢„æ„å»ºçš„ç½‘ç«™åŠŸèƒ½æ–‡æ¡£
  static: {
    sites: Map<string, SiteKnowledge>
    search: (query: string) => Promise<Document[]>
  }
  
  // åŠ¨æ€å±‚ï¼šå®æ—¶é¡µé¢åˆ†æ
  dynamic: {
    analyzePage: (dom: Document) => PageContext
    extractActions: (context: PageContext) => Action[]
  }
}
```

#### 3. **æµè§ˆå™¨è‡ªåŠ¨åŒ–**
```typescript
// è‡ªåŠ¨åŒ–ä»»åŠ¡æ‰§è¡Œå™¨
class AutomationExecutor {
  async executeTask(task: AutomationTask) {
    const browser = await playwright.chromium.launch()
    const page = await browser.newPage()
    
    // ä½¿ç”¨çŠ¶æ€æœºç®¡ç†æ‰§è¡Œæµç¨‹
    const machine = createTaskMachine(task)
    
    // æ”¯æŒä¸­æ–­å’Œæ¢å¤
    machine.onTransition((state) => {
      if (state.value === 'paused') {
        // ä¿å­˜çŠ¶æ€ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥
        await this.saveSnapshot(task.id, state.context)
      }
    })
  }
}
```

### å››ã€æ¨èå®ç°æµç¨‹ï¼ˆ6ä¸ªé˜¶æ®µï¼‰

#### **ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æ¡†æ¶ï¼ˆ2å‘¨ï¼‰**
1. æ­å»ºmonorepoé¡¹ç›®ç»“æ„
2. å®ç°å‰ç«¯æ‚¬æµ®ç»„ä»¶åŸºç¡€UI
3. å»ºç«‹WebSocketé€šä¿¡
4. æ­å»ºåç«¯åŸºç¡€æœåŠ¡æ¡†æ¶

**äº¤ä»˜ç‰©**ï¼šèƒ½æ˜¾ç¤ºæ‚¬æµ®çƒå¹¶å»ºç«‹å‰åç«¯è¿æ¥

#### **ç¬¬äºŒé˜¶æ®µï¼šè¯­éŸ³åŠŸèƒ½ï¼ˆ1å‘¨ï¼‰**
1. é›†æˆWeb Speech API
2. å¯¹æ¥ç«å±±äº‘/é˜¿é‡Œäº‘è¯­éŸ³æœåŠ¡
3. å®ç°è¯­éŸ³å½•åˆ¶å’Œæ’­æ”¾
4. æ·»åŠ è¯­éŸ³è¯†åˆ«é”™è¯¯å¤„ç†

**äº¤ä»˜ç‰©**ï¼šæ”¯æŒè¯­éŸ³è¾“å…¥è¾“å‡ºçš„å¯¹è¯

#### **ç¬¬ä¸‰é˜¶æ®µï¼šLLMé›†æˆï¼ˆ1å‘¨ï¼‰**
1. å®ç°LLM APIç½‘å…³
2. æ·»åŠ å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
3. å®ç°Function CallåŸºç¡€æ¡†æ¶
4. æ·»åŠ æµå¼å“åº”æ”¯æŒ

**äº¤ä»˜ç‰©**ï¼šèƒ½è¿›è¡Œæ™ºèƒ½å¯¹è¯

#### **ç¬¬å››é˜¶æ®µï¼šMCPæ”¯æŒï¼ˆ2å‘¨ï¼‰**
1. é›†æˆMCP SDK
2. å®ç°DuckDuckGoæœç´¢è¿æ¥
3. æ„å»ºMCPå·¥å…·æ³¨å†Œæœºåˆ¶
4. æ·»åŠ å·¥å…·è°ƒç”¨çš„UIåé¦ˆ

**äº¤ä»˜ç‰©**ï¼šèƒ½é€šè¿‡MCPè°ƒç”¨å¤–éƒ¨å·¥å…·

#### **ç¬¬äº”é˜¶æ®µï¼šçŸ¥è¯†åº“ç³»ç»Ÿï¼ˆ2å‘¨ï¼‰**
1. æ­å»ºå‘é‡æ•°æ®åº“
2. å®ç°ç½‘é¡µçˆ¬è™«å’Œè§£æå™¨
3. æ„å»ºçŸ¥è¯†ç´¢å¼•å’Œæ£€ç´¢
4. å®ç°åŠ¨æ€é¡µé¢åˆ†æ

**äº¤ä»˜ç‰©**ï¼šèƒ½åŸºäºçŸ¥è¯†åº“å›ç­”é—®é¢˜

#### **ç¬¬å…­é˜¶æ®µï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼ˆ3å‘¨ï¼‰**
1. é›†æˆPlaywright
2. å®ç°ä»»åŠ¡çŠ¶æ€æœº
3. æ„å»ºä»»åŠ¡ä¸­æ–­-æ¢å¤æœºåˆ¶
4. æ·»åŠ æ‰§è¡Œè¿›åº¦å®æ—¶åé¦ˆ
5. å®ç°å®‰å…¨æ²™ç®±

**äº¤ä»˜ç‰©**ï¼šå®Œæ•´çš„è‡ªåŠ¨åŒ–æ‰§è¡Œèƒ½åŠ›

### äº”ã€é¡¹ç›®ç»“æ„

```
web-assistant/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ client/              # å‰ç«¯SDK
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/  # UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ services/    # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â””â”€â”€ utils/       # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ dist/           # æ„å»ºäº§ç‰©
â”‚   â”‚
â”‚   â”œâ”€â”€ server/             # åç«¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ gateway/        # APIç½‘å…³
â”‚   â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ mcp/           # MCPæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ automation/    # è‡ªåŠ¨åŒ–æœåŠ¡
â”‚   â”‚   â””â”€â”€ knowledge/     # çŸ¥è¯†åº“æœåŠ¡
â”‚   â”‚
â”‚   â””â”€â”€ shared/            # å…±äº«ä»£ç 
â”‚       â”œâ”€â”€ types/         # TypeScriptç±»å‹
â”‚       â””â”€â”€ constants/     # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ infrastructure/        # åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ docker/           # Dockeré…ç½®
â”‚   â””â”€â”€ k8s/             # Kubernetesé…ç½®
â”‚
â”œâ”€â”€ scripts/              # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ crawler/         # çŸ¥è¯†åº“çˆ¬è™«
â”‚   â””â”€â”€ deploy/          # éƒ¨ç½²è„šæœ¬
â”‚
â””â”€â”€ docs/                # æ–‡æ¡£
    â”œâ”€â”€ api/            # APIæ–‡æ¡£
    â””â”€â”€ guides/         # ä½¿ç”¨æŒ‡å—
```

### å…­ã€å…³é”®é…ç½®ç¤ºä¾‹

**TypeScripté…ç½®**ï¼š
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "commonjs",
    "lib": ["ES2022", "DOM"],
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "paths": {
      "@shared/*": ["../shared/*"]
    }
  }
}